# 1. Use 2025-standard stable slim image
FROM python:3.11-slim

# 2. Set optimized environment variables
# ENV PYTHONUNBUFFERED=1 \
#     PIP_NO_CACHE_DIR=1 \
#     PIP_DISABLE_PIP_VERSION_CHECK=1

WORKDIR /app

# Add these to your Dockerfile under WORKDIR
ENV LITELLM_LOG=ERROR \
    DISABLE_AUTO_LOGGING=True \
    PYTHONUNBUFFERED=1


# 3. Install necessary build tools (required for many AI/Groq libraries)
RUN apt-get update && \
    apt-get install -y --no-install-recommends build-essential && \
    rm -rf /var/lib/apt/lists/*

# 4. Install dependencies first to leverage Docker cache
RUN pip install --upgrade pip setuptools wheel

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Ensure latest pip and then install litellm with proxy extras
# RUN pip install --no-cache-dir --upgrade pip && \
#     pip install --no-cache-dir "litellm[proxy]" apscheduler
# Replace your current line with this:
RUN pip install --no-cache-dir "litellm[proxy]>=1.75.9" apscheduler



# 5. Copy the rest of the application
COPY . .

# 6. Default execution command
CMD ["python", "Single_Agent_using_Groq.py"]
